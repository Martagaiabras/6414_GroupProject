---
title: '6414 Group Project - Telecom Customer Churn Modeling '
author: "Jared Babcock, Rishi Bubna, Marta Bras"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '2'
  pdf_document:
    toc: yes
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
source("LoadingData.R")
source("CSS.R")
```

# Introduction

Customer churn (or customer attrition) analysis is one of the vital measures for subscription-based business models such as telecom services, internet providers. This is more important in business sectors that have high competition. Companies can choose to increase engagement with customers that are expected to churn to retain them, which would lead the company to increase revenue.

## Summary (goals and major findings)

## Project goals

1. Building a predictive model for churn rate that best identifies which customers are likely to churn.

2. Building a predictive model for CLTV that best identifies how much a customer is worth for the company.

3. Perform customer segmentation to identify high value customers that are likely to churn.

## Reasons for our study

## A Priori Expectations

# Data

The IBM Business Analytics Community provides a fictional dataset of over 7,000 customers for a telecom company that contains information about which customers have left, stayed, or signed up for their service. The dataset also contains major demographic information for customers, along with Satisfaction Score, Churn Score, and Customer Lifetime Value (CLTV) index.

The database has data from 7,043 telecom customers, all located in California (USA). The average tenure of the customers is 32 months with an average churn rate of 59% and an average CLTV of 4,400$.

```{r}
summary_table <- dat %>% 
  summarize(`number observations(#)` = length(CustomerID),
            `average tenure (months)` = (mean(`Tenure Months`)),
            `min tenure (months)` = min(`Tenure Months`),
            `max tenure (months)` = max(`Tenure Months`),
            `average churn rate(%)` = mean(`Churn Score`),
            `min churn rate(%)` = min(`Churn Score`),
            `max churn rate(%)` = max(`Churn Score`),
            `average CLTV($)` = mean(CLTV),
            `min CLTV($)` = min(CLTV),
            `max CLTV($)` = max(CLTV))


summary_table <-  t(summary_table)

kable(summary_table, digits = 0, format = "latex", booktabs = T, caption = "Demo Table") %>%
  kable_styling(latex_options = c("striped", "hold_position"),
                full_width = F)
```


```{r fig.align = "center", fig.height=6}
slices <- table(dat$`Churn Value`)
lbls <- c("churned", "not churned")
pct <- round(slices/sum(slices)*100)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
par(mfrow = c(1,2))
pie(slices,labels = lbls, col=j_colors, cex.lab=0.5)

```

# Explanatory Data Analysis

```{r, fig.height=5}
ggplot(dat, aes(x=`Churn Score`)) + 
  geom_histogram(binwidth = 5, fill = "grey") +
  ggtitle("Histogram of Churn Score") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
  panel.grid.minor = element_blank()) +
  theme(plot.title = element_text(size=11))  
```


```{r, fig.height=4}
ggplot_1 <- ggplot(dat, aes(y=`Churn Score`, x= Gender, color = Gender,  palette = "jco")) +
  geom_boxplot() +
  ggtitle("Boxplot of Gender") +
  theme_bw() + 
  theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),  axis.title.x =element_text(size=8),  axis.title.y = element_text(size=8)) +
  theme(plot.title = element_text(size=8)) 

ggplot_2 <- ggplot(dat, aes(y=`Churn Score`, x= `Senior Citizen`, color = `Senior Citizen`,  palette = "jco")) +
  geom_boxplot() +
  ggtitle("Boxplot of seniority") +
  theme_bw() + 
  theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),  axis.title.x =element_text(size=8),  axis.title.y = element_text(size=8)) +
  theme(plot.title = element_text(size=8)) 

ggplot_3 <- ggplot(dat, aes(y=`Churn Score`, x= Dependents, color = Dependents ,  palette = "jco")) +
  geom_boxplot() +
  ggtitle("Boxplot of dependents") +
  theme_bw() + 
  theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),  axis.title.x =element_text(size=8),  axis.title.y = element_text(size=8)) +
  theme(plot.title = element_text(size=8)) 

ggplot_4 <- ggplot(dat, aes(y=`Churn Score`, x=`Phone Service`, color =`Phone Service`,  palette = "jco")) +
  geom_boxplot() +
  ggtitle("Boxplot of phone service") +
  theme_bw() + 
  theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),  axis.title.x =element_text(size=8),  axis.title.y = element_text(size=8)) +
  theme(plot.title = element_text(size=8)) 

ggarrange(ggplot_1,ggplot_2, ggplot_3, ggplot_4, nrow = 2, ncol =2)
```


# Churn Rate : Predictive model 

## 1. Full model 
## 2. Model fit
## 3. Variable transformation
## 4. Re-running the model
## 5. Variable selection
## 6. Model selection


#  CLTV : Predictive model 

## 1. Full model 
## 2. Model fit
## 3. Variable transformation
## 4. Re-running the model
## 5. Variable selection
## 6. Model selection


# Customer segmentation

## 1. Identification of high value customers 
## 2. Targeting of high value customers


# Conclusions
# Subject Matter Implications
# Limitations and next steps
# Attachments